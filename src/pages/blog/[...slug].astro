---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Calendar, User, ArrowLeft } from "lucide-react";

export async function getStaticPaths() {
    const posts = await getCollection("blog");
    return posts.map((post) => ({
        params: { slug: post.slug },
        props: { post },
    }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout title={`${post.data.title} - AWS User Group Jakarta`}>
    <div class="bg-muted/30 py-12 md:py-20">
        <div class="container max-w-4xl">
            <Button
                variant="ghost"
                className="mb-8 pl-0 hover:pl-0 hover:bg-transparent text-muted-foreground hover:text-foreground"
                asChild
            >
                <a href="/blog">
                    <ArrowLeft className="mr-2 h-4 w-4" /> Back to Blog
                </a>
            </Button>

            <div class="space-y-4">
                <div class="flex flex-wrap gap-2">
                    {
                        post.data.tags?.map((tag) => (
                            <Badge
                                variant="secondary"
                                className="bg-background/80 backdrop-blur"
                            >
                                {tag}
                            </Badge>
                        ))
                    }
                </div>

                <h1
                    class="text-4xl font-extrabold tracking-tight lg:text-5xl text-foreground"
                >
                    {post.data.title}
                </h1>

                <div
                    class="flex items-center gap-6 text-muted-foreground text-sm font-medium"
                >
                    <div class="flex items-center">
                        <User className="mr-2 h-4 w-4" />
                        {post.data.author}
                    </div>
                    <div class="flex items-center">
                        <Calendar className="mr-2 h-4 w-4" />
                        {
                            post.data.pubDate.toLocaleDateString("en-US", {
                                year: "numeric",
                                month: "long",
                                day: "numeric",
                            })
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container max-w-4xl py-12">
        {
            post.data.image && (
                <div class="rounded-2xl overflow-hidden mb-12 border border-border/50 shadow-lg">
                    <img
                        src={post.data.image}
                        alt={post.data.title}
                        class="object-cover w-full h-auto max-h-[500px]"
                    />
                </div>
            )
        }

        <article
            class="prose prose-lg dark:prose-invert max-w-none prose-headings:font-bold prose-headings:tracking-tight prose-a:text-primary prose-img:rounded-xl"
        >
            <Content />
        </article>
    </div>
</Layout>
